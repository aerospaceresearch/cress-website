{% extends 'base.html' %}
{% load static %}

{% block page_title %}
user controlled plant growing
{% endblock %}

{% block content %}

<div class="row">
  <div class="col m8">
      <div class="row">
        <div class="col m6">
          <div class="card blue-grey darken-1 hoverable">
            <div class="card-content white-text">
              <span class="card-title">cress.space</span>
              <p>user controlled plant growing</p>
            </div>
            <div class="card-action">
	      <a href="https://2016.spaceappschallenge.org/challenges/mars/simspace/projects/cress.space" role="button">Learn more</a>
	      <a href="https://twitter.com/cress_space" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @cress_space</a>
	      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
            </div>
          </div>
        </div>

{% if outside_image %}
        <div class="col m6">
          <div class="card small hoverable">
            <div class="card-image">
              <img src="{{ outside_image.image.url }}">
	      <span class="card-title"></span>
            </div>
            <div class="card-content">
	      <p>photo from {{ outside_image.created }} </p>
            </div>
	    <div class="card-action">
              <a href="{{ outside_image.image.url }}">Image in full size</a>
	    </div>
          </div>
        </div>
{% endif %}

	<div class="row">
	  {% for photo in photos %}
          <div class="col m6">
	    <div class="card small hoverable">
	      <div class="card-image">
		<img src="{{ photo.image.url }}">
		<span class="card-title"></span>
	      </div>
	      <div class="card-content">
		<p>photo from {{ photo.created }}</p>
	      </div>
	      <div class="card-action">
		<a href="{{ photo.cycle.get_absolute_url }}">current Cycle {{ photo.cycle.box }}</a>
	      </div>
	    </div>
	  </div>
	  {% endfor %}
	</div>
      </div>
  </div>
  <div class="col m4">
    <div class="collection">
      {% for cycle in cycle_list %}
      <a href="/cycle/{{ cycle.pk }}/" class="collection-item">{{ cycle.box }} - {{ cycle.name }}</a>
      {% endfor %}
    </div>
  </div>
</div>
	
{% endblock content %}

{% block bottom_js %}
{% if cycle_set == cycle.pk %}
    <script type="text/javascript">
      function load_image()
      {
        $.get('latest_photo', function (data)
        {
          $('#photo').attr('src', jQuery.parseJSON(data).url);
          $('#photo_created').text(jQuery.parseJSON(data).created);
        });
      }

      $(function() {
        // 5 minutes
        delay_ms = 1000*60*5;
        // reload image on a timer
        setInterval(load_image, delay_ms);
        // also reload image when clicking on it
        $('#photo').click(load_image);
      });
    </script>
{% endif %}
{% endblock %}
