{% extends 'base.html' %}
{% load static %}

{% block page_title %}
user controlled plant growing
{% endblock %}

{% block content %}
<div class="block-area">
  <a href="https://github.com/aerospaceresearch/cress-website"><img style="position: absolute; top: 60px; right: 0; border: 0;" src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>
    <div class="row well tile">
      <div>
            <h1>user controlled plant growing</h1>
            <h2>
	      shackspace BOX 1
            </h2>
      </div>
      <div>
	<div class="col-md-12">
	  {% for cycle in cycle_list %}
	  <a {% if cycle_set != cycle.pk %}href="?cycle={{ cycle.pk }}" {% endif %}class="btn btn-raised{% if cycle_set == cycle.pk %} btn-default active{% else %} btn-primary{% endif %}">{{ cycle.name }}</a>
	  {% endfor %}
	  <a class="btn btn-lg btn-raised btn-primary" href="https://2016.spaceappschallenge.org/challenges/mars/simspace/projects/cress.space" role="button">Learn more</a>
	</div>
	<div class="col-md-12">
        <div class="col-md-6">
	    <p>
	      <img id="photo" src="{{ image.image.url }}" class="img-responsive"/><br/>
	      <strong><span id="photo_created" style="font-size:10px">{{ image.created }}</span></strong>
	    </p>
	    <p>
	      <div class="alert alert-info">
		<strong>
		  User interaction will be added later when we have more test growings done.
		</strong>
	      </div>
	    </p>
{% comment %}
            {% if user.is_authenticated %}
	      <h3>ACTION: UV light (less) (no change) (more)</h3>
	      <h3>ACTION: Water (less) (no change) (more)</h3>
	    {% else %}
	      <h3>Please <a href="/login">log in</a> to participate</h3>
	    {% endif %}
{% endcomment %}
        </div>
        <div class="col-md-6">
	  <div class="table-responsive">
	    {% if sensor_list %}
	    <table class="table table-striped table-condensed">
	      <tr><th>sensor</th><th>type</th><th>position</th><th>value</th><th>created</th></tr>
	      {% for sensor in sensor_list %}
	      <tr>
		<td>{{ sensor.sensor_type }}</td><td>{{ sensor.value_type }}</td><td>{{ sensor.position }}</td><td>{{ sensor.value }}{% if sensor.unit != '-' %} {{ sensor.unit }}{% endif %}</td>
		<td><span style="font-size:9px">{{ sensor.created }}:</span></td>
	      </tr>
	      {% endfor %}
	    </table>
	    {% endif %}
	  </div>
        </div>
      </div>
        <div>
	    {% for image in older_images %}
	      {% if forloop.first %}
	      <h4>previous photos</h4>
	      {% endif %}
	    <p class="col-md-6">
	      <img src="{{ image.image.url }}" class="img-responsive"/><br/>
	      <strong><span style="font-size:10px">{{ image.created }}</span></strong>
	    </p>
	    {% endfor %}
	</div>
      </div>
    </div>
</div>
{% endblock content %}

{% block bottom_js %}
    <script type="text/javascript">
      function load_image()
      {
        $.get('latest_photo', function (data)
        {
          $('#photo').attr('src', jQuery.parseJSON(data).url);
          $('#photo_created').text(jQuery.parseJSON(data).created);
        });
      }

      $(function() {
        // 5 minutes
        delay_ms = 1000*60*5;
        // reload image on a timer
        setInterval(load_image, delay_ms);
        // also reload image when clicking on it
        $('#photo').click(load_image);
      });
    </script>
{% endblock %}
